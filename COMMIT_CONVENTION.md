# 提交消息规范

本项目使用[约定式提交规范](https://www.conventionalcommits.org/zh-hans/)，并进行了项目特定的扩展。

## 提交消息格式

每个提交消息由**标题**、**正文**和**脚注**组成：

```
<类型>[可选的作用域]: <描述>

[可选的正文]

[可选的脚注]
```

### 类型

提交消息的类型字段必须是以下之一：

#### 标准类型

- **feat**: 新增功能
- **fix**: Bug修复
- **docs**: 文档更新
- **style**: 代码风格调整（不影响代码功能）
- **refactor**: 代码重构（既不是修复bug也不是添加新功能）
- **perf**: 性能优化
- **test**: 添加或修改测试
- **build**: 构建系统或外部依赖变更
- **ci**: CI配置变更
- **chore**: 其他变更（不修改src或测试文件）
- **revert**: 回退提交

#### 数据相关类型

- **data**: 数据更新（通用）
- **data:etl**: 数据ETL流程相关变更
- **data:schema**: 数据模式/结构变更
- **data:quality**: 数据质量改进
- **data:viz**: 数据可视化相关变更

#### 机器学习相关类型

- **ml:model**: 模型定义或架构更新
- **ml:train**: 训练流程相关变更
- **ml:eval**: 模型评估方法变更
- **ml:feat**: 特征工程相关变更
- **ml:deploy**: 模型部署相关变更

#### 其他专业类型

- **api**: API变更
- **ui**: 用户界面变更
- **security**: 安全相关变更
- **db**: 数据库变更
- **config**: 配置更新
- **dep**: 依赖更新
- **infra**: 基础设施变更
- **monitor**: 监控系统相关
- **scale**: 扩展性改进

### 作用域

作用域是可选的，用于提供额外的上下文信息：

```
feat(auth): 添加用户认证功能
```

### 示例

```
feat(auth): 添加基于JWT的用户认证

- 实现登录/注销API端点
- 添加访问令牌和刷新令牌支持
- 集成用户权限验证

Closes #123
```

```
data:schema(user): 更新用户数据模型

添加新的用户偏好字段以支持个性化功能。
```

## 自动化变更日志

本项目使用自定义脚本从提交历史自动生成变更日志。使用正确的提交类型和格式可以确保变更日志的准确性和可读性。

要生成变更日志，请运行：

```bash
make changelog
```

### 错误处理与日志

变更日志生成脚本包含健壮的错误处理机制：

- 配置错误检测：能识别并报告配置文件中的YAML/JSON格式错误，包括行号和列号
- 彩色输出：使用彩色终端输出区分错误（红色）、警告（黄色）、信息（蓝色）和成功（绿色）消息
- 详细模式：使用`--verbose`或`-v`参数获取更详细的执行信息

遇到问题时，可以使用以下命令获取更多诊断信息：

```bash
python scripts/generate_changelog.py --verbose
```
